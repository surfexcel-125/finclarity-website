<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Articles | Finclarity</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">

    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Custom Styles -->
    <style>
        html {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        html::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }
        body {
            background-color: #0c111e; /* Fallback */
            background-image: radial-gradient(circle at top left, rgba(26, 35, 54, 0.8), transparent 40%),
                              radial-gradient(circle at bottom right, rgba(26, 35, 54, 0.8), transparent 40%);
            background-attachment: fixed; /* This ensures the background covers the entire page */
            color: #f4f6f9;
            font-family: 'Source Sans Pro', sans-serif;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Montserrat', sans-serif;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            -webkit-backdrop-filter: blur(15px);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1.5rem;
            transition: all 0.3s ease;
        }
        .glass-card-hover:hover {
             border-color: rgba(0, 82, 204, 0.5);
             transform: translateY(-5px);
        }
        .article-content {
            line-height: 1.75;
        }
        .article-content h1, .article-content h2, .article-content h3 {
             border-top: 1px solid rgba(255, 255, 255, 0.1);
             padding-top: 1.5rem;
             margin-top: 1.5rem;
        }
        /* View Controller */
        .page-view {
            display: none;
        }
        .page-view.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* --- NEW: Article loading animation --- */
        .article-item-animate {
            opacity: 0; /* Start hidden */
            animation: slideDownFadeIn 0.5s ease-out forwards;
        }

        @keyframes slideDownFadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body class="antialiased">

    <!-- Header / Navigation -->
    <header id="header" class="bg-[#111827]/30 backdrop-blur-md sticky top-0 z-30">
        <div class="container mx-auto flex justify-between items-center p-4">
            <div class="flex items-center gap-4">
                <a href="member_dashboard.html" class="text-white hover:text-blue-400 p-2 rounded-full hover:bg-white/10" title="Back to Dashboard">
                    <i class="fas fa-arrow-left fa-lg"></i>
                 </a>
                <div class="text-2xl font-bold tracking-wider text-white" id="logo">
                    <a href="index.html">FINCLARITY</a>
                </div>
            </div>
            <nav class="flex items-center gap-4">
                 <span class="hidden sm:inline text-gray-300">Welcome, Member</span>
                 <a href="#" class="text-white p-2 rounded-full hover:bg-white/10"><i class="fas fa-user-circle fa-lg"></i></a>
            </nav>
        </div>
    </header>

    <!-- Main container for both views -->
    <main class="container mx-auto p-4 md:p-8">

        <!-- View 1: Articles List -->
        <div id="articles-list-view" class="page-view active">
            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-5xl font-bold">All Articles</h1>
                <p class="text-lg text-gray-400 mt-4 max-w-2xl mx-auto">Browse our library of in-depth guides and strategies, designed to provide clarity on your financial journey.</p>
            </div>
            <div id="articles-container" class="space-y-6 max-w-4xl mx-auto">
                <!-- Articles will be dynamically loaded here by Firebase -->
                <p class="text-center text-gray-400">Loading articles...</p>
            </div>
        </div>
        
        <!-- View 2: Full Article -->
        <div id="full-article-view" class="page-view">
            <div class="max-w-4xl mx-auto">
                <a href="#" id="back-to-list-btn" class="text-blue-400 hover:text-blue-300 mb-6 inline-block">
                    &larr; Back to All Articles
                </a>
                <div class="glass-card">
                    <div class="p-6 md:p-10">
                        <h1 id="article-title-full" class="text-4xl md:text-5xl font-bold leading-tight mb-4"></h1>
                        <div id="article-meta-full" class="flex items-center text-gray-400 mb-8"></div>
                        <article id="article-content-full" class="article-content text-gray-300"></article>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <!-- Firebase SDK Scripts -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js";
        import { getFirestore, collection, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore.js";

        // IMPORTANT: Replace with your actual Firebase config
        const firebaseConfig = {
        	apiKey: "AIzaSyCRtzONV0M1syCLTF6H5__cGEBgJxM13sM",
    		authDomain: "adminpanel-93879.firebaseapp.com",
    		projectId: "adminpanel-93879",
    		storageBucket: "adminpanel-93879.appspot.com",
    		messagingSenderId: "854889610123",
    		appId: "1:854889610123:web:4522c7fc685e9864014d8e"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const articlesListView = document.getElementById('articles-list-view');
        const fullArticleView = document.getElementById('full-article-view');
        const articlesContainer = document.getElementById('articles-container');
        const backToListBtn = document.getElementById('back-to-list-btn');

        let allArticles = []; // Cache to store fetched articles

        // --- REAL-TIME LISTENER FOR ARTICLES ---
        const q = query(collection(db, "articles"), orderBy("createdAt", "desc"));
        onSnapshot(q, (querySnapshot) => {
            articlesContainer.innerHTML = ''; // Clear existing list
            allArticles = []; // Clear cache
            
            if (querySnapshot.empty) {
                articlesContainer.innerHTML = '<p class="text-center text-gray-400">No articles published yet.</p>';
                return;
            }

            querySnapshot.forEach((doc, index) => { // Added index for animation delay
                const article = { id: doc.id, ...doc.data() };
                allArticles.push(article);

                const articleEl = document.createElement('a');
                articleEl.href = '#';
                // --- MODIFIED: Added animation class ---
                articleEl.className = 'glass-card glass-card-hover block p-6 md:p-8 article-item-animate';
                articleEl.dataset.id = article.id;

                // --- NEW: Staggered animation delay ---
                articleEl.style.animationDelay = `${index * 0.1}s`;
                
                const formattedDate = article.createdAt?.toDate().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) || 'No date';

                articleEl.innerHTML = `
                    <div class="md:flex justify-between items-center">
                        <div>
                            <h2 class="text-2xl font-bold mb-2">${article.title}</h2>
                            <p class="text-gray-400 mb-4 md:mb-0">By ${article.author}</p>
                        </div>
                        <div class="text-gray-400 text-sm text-left md:text-right flex-shrink-0">
                            <span>${formattedDate}</span>
                            <span class="mx-2">&bull;</span>
                            <span>${article.readTime}</span>
                        </div>
                    </div>
                `;
                articlesContainer.appendChild(articleEl);
            });
        });

        // --- NAVIGATION LOGIC ---
        function showListView() {
            fullArticleView.classList.remove('active');
            articlesListView.classList.add('active');
            window.scrollTo(0, 0);
        }

        function showFullArticleView(articleId) {
            const article = allArticles.find(a => a.id === articleId);
            if (!article) return;

            document.getElementById('article-title-full').textContent = article.title;
            const formattedDate = article.createdAt?.toDate().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) || 'No date';
            document.getElementById('article-meta-full').innerHTML = `
                <span>By ${article.author}</span>
                <span class="mx-2">&bull;</span>
                <span>${formattedDate}</span>
                <span class="mx-2">&bull;</span>
                <span>${article.readTime}</span>
            `;
            document.getElementById('article-content-full').innerHTML = article.content;

            articlesListView.classList.remove('active');
            fullArticleView.classList.add('active');
            window.scrollTo(0, 0);
        }

        // Event delegation for clicking on an article
        articlesContainer.addEventListener('click', (e) => {
            const articleLink = e.target.closest('a[data-id]');
            if (articleLink) {
                e.preventDefault();
                showFullArticleView(articleLink.dataset.id);
            }
        });

        backToListBtn.addEventListener('click', (e) => {
            e.preventDefault();
            showListView();
        });

    </script>
</body>
</html>
